name: Update RSS Feed

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 */1 * *'  # Run daily

jobs:
  update-rss:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Download latest RSS feed
        run: |
          curl -L -f -o rss.xml.tmp https://blog.ediri.io/rss.xml
          # Verify the file is valid XML
          if [ -s rss.xml.tmp ]; then
            mv rss.xml.tmp rss.xml
            echo "RSS feed downloaded successfully"
          else
            echo "Error: Downloaded file is empty"
            exit 1
          fi
          
      - name: Commit and push if changed
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: 'Update RSS feed from blog'
          commit_user_name: rss-updater ðŸ¤–
          commit_user_email: actions@github.com
          commit_author: rss-updater ðŸ¤– <actions@github.com>
          file_pattern: 'rss.xml'
